================================================================================
                    WhatsApp Automation App - Feature Documentation
================================================================================

Project: WhatsApp Message Scheduler
Description: Automated WhatsApp messaging system with web UI and API
Technology: Python (FastAPI + Selenium) + React (TypeScript + Shadcn UI)

================================================================================
                              CORE FEATURES
================================================================================

1. MESSAGE TYPES
   ============

   1.1. Text Messages
        - Send plain text messages to WhatsApp groups
        - Support for multi-line messages
        - Unicode and emoji support
        - Message length: Unlimited

   1.2. Image Sharing
        - Send images with optional captions
        - Supported formats: JPG, PNG, GIF, WebP
        - Upload images through web UI or provide file paths
        - Images stored in uploads/ directory
        - Caption support with emojis and formatting

   1.3. Polls
        - Create WhatsApp polls with customizable options
        - Poll options: 2-12 choices per poll
        - Single choice polls (select one option)
        - Multiple choice polls (select multiple options)
        - Custom question text
        - Automatic poll creation in WhatsApp Web


2. SCHEDULING CAPABILITIES
   =======================

   2.1. One-Time Schedules
        - Send messages at a specific date and time
        - Format: "YYYY-MM-DD HH:MM" (e.g., "2025-11-06 15:30")
        - Timezone: Uses system timezone
        - Minimum delay: Current minute (schedules for next occurrence)

   2.2. Daily Recurring
        - Send messages every day at a specified time
        - Format: "HH:MM" (e.g., "09:00")
        - Repeats indefinitely until manually stopped
        - Automatic time-only format detection

   2.3. Hourly Recurring
        - Send messages every hour
        - Can be set to start at any specific time
        - Continues hourly indefinitely
        - Useful for reminders and notifications

   2.4. Weekday-Specific Schedules
        - Send on specific days of the week
        - Available days: Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday
        - Multiple days can be selected
        - Time-specific for each day
        - Repeats weekly on selected days

   2.5. Batch Scheduling
        - Create multiple schedules at once
        - Schedule same message to different groups
        - Schedule different messages to same group
        - No limit on number of schedules


3. MULTI-GROUP SUPPORT
   ===================

   3.1. Single Group Messaging
        - Send to one WhatsApp group
        - Search groups by exact name
        - Automatic group selection

   3.2. Multi-Group Messaging
        - Send same message to multiple groups simultaneously
        - Group list separated by commas
        - Example: "Group 1, Group 2, Group 3"
        - Each group processed sequentially
        - Automatic delay between groups (0.3s wait time)

   3.3. Group Name Management
        - Save frequently used group names
        - Quick selection from dropdown
        - Add new group names on-the-fly
        - Delete unused group names
        - Group names stored in group_names.json
        - Autocomplete suggestions


4. WEB USER INTERFACE
   ===================

   4.1. Main Dashboard
        - View all pending schedules
        - Real-time scheduler status (Running/Stopped)
        - Start/Stop scheduler with one click
        - Add new schedules via form
        - Edit existing schedules
        - Delete schedules individually
        - Filter schedules by type
        - Sort by schedule time
        - Responsive design (works on mobile/tablet/desktop)

   4.2. Schedule Creation Form
        - Tabbed interface for Message/Image/Poll
        - Date/time picker with calendar
        - Time-only mode for recurring schedules
        - File upload for images with drag-and-drop
        - Multi-group selector with checkboxes
        - Group name autocomplete
        - Form validation
        - Real-time preview

   4.3. Schedule Cards
        - Visual display of each schedule
        - Shows: Type, Message/Image/Poll preview, Time, Groups
        - Color-coded by type (Message/Image/Poll)
        - Edit button with dialog
        - Delete button with confirmation
        - Status indicators
        - Time remaining display

   4.4. Edit Schedule Dialog
        - Modify existing schedules
        - Same functionality as creation form
        - Pre-filled with existing data
        - Save changes instantly
        - Cancel without saving

   4.5. Group Management Interface
        - Manage saved group names
        - Add new groups
        - Delete groups
        - Search/filter groups
        - Accessible from main form

   4.6. History Page (Finished Schedules)
        - View all completed schedules
        - Shows execution timestamp
        - Display original message/image/poll details
        - Delete individual history items
        - Clear all history with one click
        - Persistent storage in finishedSchedules.json

   4.7. Header & Navigation
        - Scheduler status indicator (green=running, red=stopped)
        - Start/Stop toggle button
        - Navigation to History page
        - Responsive navigation menu
        - Footer with app information


5. CLI (COMMAND LINE INTERFACE)
   ============================

   5.1. Immediate Send Commands
        - Send text message now:
          python main.py send "Group Name" "Message text"

        - Send image now:
          python main.py send-image "Group Name" "/path/to/image.jpg" "Caption"

        - Send poll now:
          python main.py send-poll "Group Name" "Question" "Option1,Option2,Option3"

   5.2. Schedule Commands
        - Schedule message:
          python main.py schedule "Group Name" "Message" "2025-11-06 15:30"

        - Schedule image:
          python main.py schedule-image "Group Name" "/path/image.jpg" "Caption" "15:30"

        - Schedule poll:
          python main.py schedule-poll "Group Name" "Question?" "Opt1,Opt2" "daily"

   5.3. Interactive Mode
        - Launch: python main.py interactive
        - Guided prompts for all inputs
        - User-friendly for non-technical users
        - Step-by-step instructions
        - Input validation

   5.4. Scheduler Management
        - List schedules: python main.py list
        - Start scheduler: python main.py start
        - Stop scheduler: python main.py stop
        - View status: python main.py status


6. REST API
   ========

   6.1. Schedule Management Endpoints
        - GET /schedules
          Returns all pending schedules

        - POST /schedules/load
          Create or update schedules
          Body: Array of schedule objects

        - POST /schedules/save
          Save schedules to file

   6.2. Scheduler Control Endpoints
        - GET /scheduler/status
          Returns: {"running": true/false}

        - POST /scheduler/start
          Starts the background scheduler

        - POST /scheduler/stop
          Stops the background scheduler

   6.3. File Upload Endpoints
        - POST /upload
          Upload image file
          Returns: Absolute file path
          Max size: 10MB (configurable)

   6.4. History Management Endpoints
        - GET /finished-schedules
          Returns all completed schedules

        - DELETE /finished-schedules/{index}
          Delete specific finished schedule

        - DELETE /finished-schedules
          Clear all finished schedules

   6.5. WhatsApp Session Endpoints
        - GET /whatsapp/status
          Check if WhatsApp Web is logged in

        - POST /whatsapp/login
          Open browser for QR code scanning

   6.6. Group Management Endpoints
        - GET /group-names
          Get all saved group names

        - POST /group-names
          Add new group name
          Body: {"name": "Group Name"}

        - DELETE /group-names/{name}
          Delete saved group name

   6.7. System Info Endpoints
        - GET /chrome-profiles
          List available Chrome profiles

        - GET /
          API welcome message


7. BROWSER AUTOMATION
   ===================

   7.1. Smart Browser Management
        - Lazy initialization (starts only when needed)
        - Automatic browser startup for first job
        - Smart closure after job completion
        - Keeps browser open if more jobs coming soon (within 10 min)
        - Reduces resource usage
        - Minimizes WhatsApp detection risk

   7.2. WhatsApp Web Integration
        - Selenium WebDriver with Chrome/Chromium
        - Automatic ChromeDriver version management
        - Headless mode support (optional)
        - Custom Chrome profile support
        - Session persistence (QR code scan once)
        - Automatic session restoration

   7.3. Session Management
        - Persistent WhatsApp login
        - Session data stored in chrome_data/
        - Multi-profile support
        - Cross-platform profile detection
        - No repeated QR code scanning

   7.4. Robust Element Detection
        - Multiple XPath selector strategies
        - Fallback selectors for reliability
        - Explicit waits for elements (WebDriverWait)
        - Optimized wait times (0.3s - 1s)
        - Handles WhatsApp UI changes gracefully

   7.5. Error Recovery
        - Browser stays open on error for debugging
        - Detailed error logging
        - Automatic retry mechanisms
        - Screenshot capture on failure (optional)


8. DATA PERSISTENCE
   ================

   8.1. Schedules Storage
        - File: schedules.json
        - Format: JSON array
        - Contains: Pending schedules
        - Auto-saves on changes
        - Atomic write operations

   8.2. History Storage
        - File: finishedSchedules.json
        - Format: JSON array
        - Contains: Completed schedules with timestamps
        - Separate from pending schedules
        - Unlimited history size

   8.3. Group Names Storage
        - File: group_names.json
        - Format: JSON array of strings
        - Persistent across sessions
        - Used for autocomplete

   8.4. Uploaded Files
        - Directory: uploads/
        - Stores uploaded images
        - Absolute paths used in schedules
        - No automatic cleanup (manual management needed)

   8.5. Session Data
        - Directory: chrome_data/
        - Contains WhatsApp session cookies
        - Browser profile data
        - Cache and local storage
        - Auto-created on first run


9. SCHEDULING ENGINE
   ==================

   9.1. Background Thread Execution
        - Daemon thread for non-blocking operation
        - Runs independently of API server
        - Checks every second for pending jobs
        - Low CPU usage when idle

   9.2. Schedule Processing
        - Exact time matching
        - Handles past times (schedules for next day)
        - Automatic schedule removal after execution
        - Moves completed schedules to history
        - Persistent schedule state

   9.3. Job Execution Flow
        1. Check if browser is needed
        2. Initialize browser if not running
        3. Navigate to WhatsApp Web
        4. Search for target group
        5. Send message/image/poll
        6. Wait for confirmation
        7. Mark schedule as complete
        8. Close browser if no more jobs soon

   9.4. Time Format Support
        - Absolute: "2025-11-06 15:30"
        - Time-only: "15:30" (recurring daily)
        - 24-hour format
        - System timezone
        - Edge case handling (midnight, past times)


10. ADVANCED FEATURES
    =================

    10.1. Chrome Profile Management
         - Detect system Chrome profiles (macOS, Windows, Linux)
         - List available profiles
         - Profile names and paths
         - Use specific profile for WhatsApp sessions
         - Multiple WhatsApp accounts support

    10.2. Poll Options
         - Single choice: Only one option selectable
         - Multiple choice: Multiple options selectable
         - 2-12 options per poll
         - Custom question text
         - Option order preserved

    10.3. Smart Time Handling
         - Past times auto-schedule for next day
         - Current minute schedules for next occurrence
         - Timezone-aware
         - Handles DST transitions

    10.4. Multi-Group Batch Processing
         - Sequential group processing
         - Automatic delays between groups
         - Independent error handling per group
         - Status tracking per group

    10.5. File Upload System
         - Web UI drag-and-drop
         - File type validation
         - Size limit enforcement
         - Unique filename generation
         - Path resolution (absolute paths)


11. CONFIGURATION & CUSTOMIZATION
    ==============================

    11.1. Environment Variables
         - .env file support
         - CHROME_PROFILE_PATH: Custom Chrome profile
         - HEADLESS: Run browser in headless mode
         - API_PORT: Custom API port (default: 8000)
         - LOG_LEVEL: Logging verbosity

    11.2. Wait Times (Customizable)
         - Group search wait: 1s
         - Message send wait: 0.5s
         - Poll creation wait: 0.3s per step
         - Browser init wait: 2s
         - Element wait timeout: 10s

    11.3. Browser Options
         - Headless mode toggle
         - Custom user agent
         - Window size configuration
         - Disable notifications
         - Disable GPU (for stability)
         - Custom download directory


12. SECURITY & PRIVACY
    ===================

    12.1. Local Execution
         - All data stored locally
         - No cloud services
         - No external API calls (except WhatsApp Web)
         - Session data encrypted by Chrome

    12.2. CORS Configuration
         - Default: Allow all origins (development)
         - Configurable for production
         - Restrict to specific domains

    12.3. File Upload Security
         - File type validation
         - Size limits
         - Sanitized filenames
         - Upload directory restrictions

    12.4. Session Security
         - WhatsApp session cookies protected
         - Chrome profile encryption
         - No password storage
         - QR code authentication only


13. PERFORMANCE FEATURES
    =====================

    13.1. Resource Optimization
         - Browser lazy loading
         - Automatic browser closure
         - Minimal memory footprint when idle
         - Efficient schedule checking (1s interval)

    13.2. Fast UI
         - React with Vite for instant HMR
         - Optimized bundle size
         - TanStack Query for caching
         - Lazy component loading

    13.3. API Performance
         - FastAPI asynchronous endpoints
         - Background thread for scheduler
         - Non-blocking operations
         - Quick response times (<50ms)

    13.4. Optimized Waits
         - Reduced from original 2-5s to 0.3-1s
         - Smart element waiting
         - No unnecessary delays
         - Faster message sending


14. ERROR HANDLING & LOGGING
    =========================

    14.1. Error Types Handled
         - Group not found
         - WhatsApp Web not loaded
         - Browser crashed
         - Network errors
         - Invalid schedule format
         - File upload errors

    14.2. Logging System
         - Console logging
         - File logging (optional)
         - Log levels: DEBUG, INFO, WARNING, ERROR
         - Timestamp on all logs
         - Colored console output

    14.3. User Feedback
         - Toast notifications in UI
         - Error messages in API responses
         - Schedule status indicators
         - Browser error screenshots


15. CROSS-PLATFORM SUPPORT
    =======================

    15.1. Operating Systems
         - macOS (tested)
         - Windows (supported)
         - Linux (supported)

    15.2. Browsers
         - Chrome (recommended)
         - Chromium
         - Brave (compatible)
         - Edge (compatible)

    15.3. Chrome Profile Detection
         - macOS: ~/Library/Application Support/Google/Chrome/
         - Windows: %LOCALAPPDATA%\Google\Chrome\User Data\
         - Linux: ~/.config/google-chrome/


16. TESTING FEATURES
    ================

    16.1. Test Scripts Included
         - test_send.py - Test text message sending
         - test_send_image.py - Test image sending
         - test_send_poll.py - Test poll creation

    16.2. Debug Mode
         - Browser visible (non-headless) for debugging
         - Detailed console logs
         - Error screenshots
         - Browser DevTools accessible


17. LIMITATIONS & KNOWN ISSUES
    ===========================

    17.1. WhatsApp Web Limitations
         - Requires active WhatsApp account
         - Phone must be online for initial QR scan
         - Subject to WhatsApp's rate limits
         - May be detected as automation (use sparingly)

    17.2. Browser Requirements
         - Chrome/Chromium must be installed
         - Sufficient RAM (minimum 2GB available)
         - Display required for QR code scan

    17.3. Current Limitations
         - No support for individual contacts (groups only)
         - No message templates
         - No scheduled message editing after start time
         - No automatic file cleanup


18. FUTURE ENHANCEMENT IDEAS
    =========================

    - Individual contact messaging support
    - Message templates library
    - Advanced scheduling (monthly, yearly)
    - Conditional scheduling (if-then rules)
    - Message analytics dashboard
    - Bulk import from CSV
    - Multiple WhatsApp accounts simultaneously
    - Desktop application (Electron wrapper)
    - Mobile app (React Native)
    - Message queue management
    - Priority scheduling
    - Automatic file cleanup
    - Webhook support for external triggers
    - Integration with calendar apps


================================================================================
                              USAGE EXAMPLES
================================================================================

Example 1: Send Daily Good Morning Message
   Schedule Type: Daily Recurring
   Time: 08:00
   Message: "Good morning team! Have a great day! â˜€ï¸"
   Groups: "Work Team"

Example 2: Send Weekly Meeting Reminder
   Schedule Type: Weekday-specific (Monday, Wednesday, Friday)
   Time: 09:00
   Message: "Meeting in 30 minutes! Join at: [meeting link]"
   Groups: "Project Team, Management"

Example 3: Send Birthday Image
   Schedule Type: One-time
   DateTime: 2025-11-06 12:00
   Image: birthday_cake.jpg
   Caption: "Happy Birthday! ðŸŽ‰ðŸŽ‚"
   Groups: "Family Group"

Example 4: Send Weekly Poll
   Schedule Type: Weekday-specific (Friday)
   Time: 16:00
   Question: "Are you available for weekend team outing?"
   Options: "Yes, I'm in!, Maybe, No, can't make it"
   Type: Single choice
   Groups: "Office Friends"

Example 5: Hourly Status Update
   Schedule Type: Hourly
   Message: "System Status: All services running normally âœ“"
   Groups: "IT Support, DevOps Team"


================================================================================
                           QUICK START GUIDE
================================================================================

1. Installation
   - Install Python 3.x
   - Install Node.js (for frontend)
   - Clone repository
   - Run: pipenv install (backend)
   - Run: npm install (frontend)

2. First Run
   - Start backend: pipenv run uvicorn server:app --reload
   - Start frontend: npm run dev
   - Open http://localhost:8080
   - Click "Start Scheduler"

3. First Schedule
   - Click "Add Schedule" tab
   - Select "Message" type
   - Enter group name
   - Enter message
   - Set time (e.g., "15:30")
   - Click "Add Schedule"

4. WhatsApp Login
   - Browser opens automatically when first job runs
   - Scan QR code with phone
   - Session saved for future use

5. Monitor & Manage
   - View schedules on dashboard
   - Edit/delete as needed
   - Check history page for completed schedules


================================================================================
                              SUPPORT & HELP
================================================================================

For issues, questions, or feature requests:
- Check README.md for detailed documentation
- Review PLAN.md for development roadmap
- Check logs for error messages
- Ensure Chrome and WhatsApp Web are accessible
- Verify phone is online for QR code scan


================================================================================
                         DOCUMENTATION VERSION
================================================================================

Version: 1.0
Last Updated: November 6, 2025
Project Version: 1.0.0
Maintained by: Project Team

================================================================================
